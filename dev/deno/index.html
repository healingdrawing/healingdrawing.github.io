<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="../../img/HD.png">
    <link rel="stylesheet" type="text/css" href="../css/style-2024-root.css">
    <title>Deno</title>
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-121264899-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());
      gtag('config', 'UA-121264899-1');
    </script>
  </head>
  
  <body class="s2">
    <button id="stop_resizing_button">Stop Resizing</button>
    
    <p id="section0" class="t s3">
      Content
    </p>
    <ul>
      <a href="https://deno.com"><li class="nav">Deno Source</li></a>
      <a href="#section1"><li class="nav">Configure Deno</li></a>
      <a href="#section2"><li class="nav">Manage Deno Projects</li></a>
      <a href="#section3"><li class="nav">API changes and deprecations</li></a>
      <a href="#section4"><li class="nav">Types and Type Declarations</li></a>
      <a href="#section5"><li class="nav">Private Modules and Repositories</li></a>
      <a href="#section6"><li class="nav">Runtime APIs</li></a>
      <a href="#section7"><li class="nav">Importing NPM Packages</li></a>
      <a href="#section8"><li class="nav">Node API Compatibility List</li></a>
      <a href="#section9"><li class="nav">JSX import source pragma(compiler directive)</li></a>
      <a href="#section10"><li class="nav">Basic Twind(tailwind-in-js) example</li></a>
      <a href="#section11"><li class="nav">Basic deno-dom(DOM and HTML parser) example</li></a>
      <a href="#section12"><li class="nav">Managing Dependencies</li></a>
      <a href="#section13"><li class="nav">Permissions(manage Deno security model)</li></a>
      <a href="#section14"><li class="nav">Manage Data (Fetch, Read, Write, Append)</li></a>
      <a href="#section15"><li class="nav">Making Scripts Executable (Unix only)</li></a>
      <a href="#section16"><li class="nav">Manage External Environment</li></a>
      <a href="#section17"><li class="nav">Manage built-in KV(key/value) Database</li></a>
    </ul>
    
    <a href="#section0">
      <p id="section1" class="t s3">
        Configure Deno
      </p>
    </a>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      curl -fsSL https://deno.land/install.sh | sh
    </p>
    
    <p>
      To install Deno. Then follow the terminal tips, to <span class="m">update the PATH variable</span>.
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno upgrade
    </p>
    
    <p>To upgrade Deno.</p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno install -Arf jsr:@deno/deployctl
    </p>
    
    <p>
      To install deployment tool.
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deployctl --help
    </p>
    
    <p>To check installation.</p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      rm -rf $HOME/.deno
    </p>
    
    <p>To uninstall Deno.</p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno info
    </p>
    
    <p>To get info about cash configuration.</p>
    
    <p class="o s1">
      DENO_DIR location: /home/user/.cache/deno
      Remote modules cache: /home/user/.cache/deno/deps
      npm modules cache: /home/user/.cache/deno/npm
      Emitted modules cache: /home/user/.cache/deno/gen
      Language server registries cache: /home/user/.cache/deno/registries
      Origin storage: /home/user/.cache/deno/location_data
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      rm -rf /home/user/.cache/deno
    </p>
    
    <p>To remove recursively cashed Deno files(use previous output paths).</p>
    
    <a href="#section0">
      <p id="section2" class="t s3">
        Manage Deno Projects
      </p>
    </a>

    <p>Terminal:</p>

    <p class="x s1">
      deno init
    </p>

    <p>To create Deno project inside the terminal current folder.</p>

    <hr>
    
    <p>Terminal:</p>

    <p class="x s1">
      deno init basic-project
    </p>

    <p>To create Deno project inside new folder <span class="m">basic-project</span>.</p>
    
    <p>Execution of <span class="m">deno init</span> command for already created project will skip all files created before. So your project will not be damaged.</p>
    
    <p class="o s1">
      ‚ÑπÔ∏è Skipped creating main.ts as it already exists
      ‚ÑπÔ∏è Skipped creating main_test.ts as it already exists
      ‚ÑπÔ∏è Skipped creating deno.json as it already exists
      ‚úÖ Project initialized

      Run these commands to get started

        # Run the program
        deno run main.ts

        # Run the program and watch for file changes
        deno task dev

        # Run the tests
        deno test
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno cache --reload my_module.ts
    </p>
    
    <p>
      To force Deno to refetch and recompile modules into the cache.
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno vendor main.ts test.deps.ts https://deno.land/std/path/mod.ts
    </p>
    
    <p>To download all remote dependencies of the specified modules into a local <span class="m">vendor</span> folder.</p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno run --no-remote --import-map=vendor/import_map.json main.ts
    </p>
    
    <p>
      To run + force Deno use the modules in the <span class="m">vendor</span> folder.
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno check module.ts
    </p>
    
    <p>
      To type-check without execution.
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno run module.ts
    </p>
    
    <p>
      To execute without type-check.
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno check --all module.ts
    </p>
    
    <p>
      To also type-check remote modules and npm packages.
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno run --check module.ts
    </p>
    
    <p>
      To type-check before execution.
    </p>
    
    <hr>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno run --check=all module.ts
    </p>
    
    <p>
      To also type-check remote modules and npm packages before execution.
    </p>
    
    <a href="#section0">
      <p id="section3" class="t s3">
        API changes and deprecations
      </p>
    </a>
    
    <a href="https://docs.deno.com/runtime/manual/advanced/migrate_deprecations#api-changes-and-deprecations">API changes and deprecations</a>
    
    <a href="#section0">
      <p id="section4" class="t s3">
        Types and Type Declarations
      </p>
    </a>
    
    <a href="https://docs.deno.com/runtime/manual/advanced/typescript/types">Types and Type Declarations</a>
    
    <a href="#section0">
      <p id="section5" class="t s3">
        Private Modules and Repositories
      </p>
    </a>
    
    <a href="https://docs.deno.com/runtime/manual/advanced/typescript/types">Private Modules and Repositories</a>
    
    <a href="#section0">
      <p id="section6" class="t s3">
        Runtime APIs
      </p>
    </a>
    
    <a href="https://deno.land/api">Runtime APIs</a>
    
    <a href="#section0">
      <p id="section7" class="t s3">
        Importing NPM Packages
      </p>
    </a>
    
    <p>main.js</p>
    
    <p class="c s1">
      import { emojify } from "npm:node-emoji@2";
      console.log(emojify(":t-rex: :heart: NPM"));
    </p>
    
    <p>Terminal:</p>
    
    <p class="x s1">
      deno run main.js
    </p>
    
    <p>Output:</p>
    
    <p class="o s1">
      ü¶ñ ‚ù§Ô∏è NPM
    </p>
    
    <p>As described in docs, using of npm packages is unstable. Do not use it without strict needs.</p>
    
    <p>Copypaste from terminal:</p>
    
    <p class="o s1">
      > emojify(":heart:");
      "‚ù§Ô∏è"
      > emojify(":t-rex:");
      "ü¶ñ"
      >
    </p>
    
    <p>Screenshot from terminal:</p>
    
    <img src="img/import-npm.png" alt="terminal screenshot">
    
    <p>In some reasons the &quot; symbol after the heart symbol is recolored in the black color(fail even with this simple example above). Also looks like import returns <span class="m">undefined</span> which probably some trash too.</p>
    
    <a href="#section0">
      <p id="section8" class="t s3">
        Node API Compatibility List
      </p>
    </a>
    
    <a href="https://docs.deno.com/runtime/manual/node/compatibility">Node API Compatibility List</a>
    
    <a href="#section0">
      <p id="section9" class="t s3">
        JSX import source pragma(compiler directive)
      </p>
    </a>
    <p>To use Preact from esm.sh, add in the source code file leading comments <span class="m">@jsxImportSource</span> pragma</p>
    
    <p class="c s1">
      /** @jsxImportSource https://esm.sh/preact */
      
      export function App() {
        return (
          &lt;div&gt;
            &lt;h1&gt;Hello, world!&lt;/h1&gt;
          &lt;/div&gt;
        );
      }
    </p>
      
    <a href="#section0">
      <p id="section10" class="t s3">
        Basic Twind(tailwind-in-js) example
      </p>
    </a>
    
    <p class="c s1">
      import { extract, install } from "https://esm.sh/@twind/core@1.1.3";
      import presetTailwind from "https://esm.sh/@twind/preset-tailwind@1.1.4";

      install({
        presets: [
          presetTailwind(),
          {
            theme: {
              fontFamily: {
                sans: ["Helvetica", "sans-serif"],
                serif: ["Times", "serif"],
              },
            },
          },
        ],
      });

      function renderBody() {
        return `&lt;!DOCTYPE html&gt;
          &lt;html lang="en"&gt;
            &lt;body class="font-sans"&gt;
              &lt;h1 class="text(3xl blue-500)"&gt;Hello from Deno&lt;/h1&gt;
            &lt;/body&gt;
          &lt;/html&gt;
        `;
      }

      function ssr() {
        const body = renderBody();
        const { html, css } = extract(body);
        return html.replace("&lt;/head&gt;", `&lt;style data-twind&gt;${css}&lt;/style&gt;&lt;/head&gt;`);
      }

      console.log(ssr());
    </p>
    
    <a href="#section0">
      <p id="section11" class="t s3">
        Basic deno-dom(DOM and HTML parser) example
      </p>
    </a>
    
    <p class="c s1">
      import {
        DOMParser,
        initParser,
      } from "https://deno.land/x/deno_dom/deno-dom-wasm-noinit.ts";
      
      (async () => {
        // initialize when you need it, but not at the top level
        await initParser();
      
        const doc = new DOMParser().parseFromString(
          `&lt;h1&gt;Lorem ipsum dolor...&lt;/h1&gt;`,
          "text/html",
        );
      })();
    </p>
    
    <a href="#section0">
      <p id="section12" class="t s3">
        Managing Dependencies
      </p>
    </a>
    
    <p>Example:</p>
    
    <p>File <span class="m">deps.ts</span> (use to manage dependencies).</p>
    
    <p class="c s1">
      export * as http from "jsr:@std/http";
      export * as path from "jsr:@std/path";
      
      export {
        add,
        multiply,
      } as remote_lib from "https://x.nest.land/ramda@0.27.0/source/index.js";
      
      export {
        add,
        multiply,
      } as local_lib from "./arithmetic.ts";
    </p>
    
    <hr>
    
    <p>File <span class="m">arithmetic.ts</span>.</p>
    
    <p class="c s1">
      /**
       * arithmetic.ts
       */
      export function add(a: number, b: number): number {
        return a + b;
      }

      export function multiply(a: number, b: number): number {
        return a * b;
      }
      
      export interface Foo {}
      export class Bar {}
      export const bang = "bang";
    </p>
    
    <hr>
    
    <p>File <span class="m">main.ts</span>.</p>
    
    <p class="c s1">
      import { path, remote_lib } from "./deps.ts";
    </p>
    
    <hr>
    
    <a href="https://docs.deno.com/runtime/manual/basics/modules/integrity_checking">
      <p>
        By using a lock file (with the <span class="m">--lock</span> command line flag), you can ensure that the code pulled from a URL is the same as it was during initial development.
      </p>
    </a>
    
    <a href="https://docs.deno.com/runtime/manual/tools/vendor">
      <p>
        For production deployment use <span class="m">deno vendor</span> subcommand to manage the host of the URL goes down case.
      </p>
    </a>
    
    <a href="https://docs.deno.com/runtime/manual/basics/modules/reloading_modules">
      <p>
        To force deno to refetch and recompile modules into the cache, use <span class="m">deno cache --reload target_module.ts</span>
      </p>
    </a>
    
    <a href="#section0">
      <p id="section13" class="t s3">
        Permissions(manage Deno security model)
      </p>
    </a>
    
    <a href="https://docs.deno.com/runtime/manual/basics/permissions">Permissions</a>
    
    <a href="#section0">
      <p id="section14" class="t s3">
        Manage Data (Fetch, Read, Write, Append)
      </p>
    </a>
    
    <p>To make a call over the web possible, add the <span class="m">--allow-net</span> flag to the <span class="m">deno run</span> terminal command.</p>
    
    <p>To convert a Deno file into a writable and readable stream or read and write files add <span class="m">--allow-read --allow-write</span> flags to the <span class="m">deno run</span> terminal command.</p>
    
    <p class="x s1">
      deno run --allow-read --allow-write --allow-net manage_data.ts
    </p>
    
    <hr>
    
    <p>The <span class="m">manage_data.ts</span> file.</p>
    
    <p class="c s1">
      /** Output: JSON Data */
      const json_response = await fetch("https://api.github.com/users/denoland");
      const json_data = await json_response.json();
      console.log(json_data);

      /** Output: HTML Data */
      const text_response = await fetch("https://deno.land/");
      const text_data = await text_response.text();
      console.log(text_data);

      /** Output: Error Message */
      try {
        await fetch("https://does.not.exist/");
      } catch (error) {
        console.log(error);
      }
      
      /** Receiving a file */
      const file_response = await fetch("https://deno.land/logo.svg");
      if (file_response.body) {
        const save_here = await Deno.open(
          "./logo.svg",
          {
            write: true,
            create: true
          }
        );
        await file_response.body.pipeTo(save_here.writable);
      }

      /** Sending a file */
      const send_file = await Deno.open(
        "./logo.svg",
        { read: true }
      );
      await fetch(
        "https://example.com/",
        {
          method: "POST",
          body: send_file.readable
        }
      );
      
      /** read file */
      const text = await Deno.readTextFile("./people.json");
      console.log(text);
      
      /** write file */
      await Deno.writeTextFile("./hello.txt", "Hello World!");
      console.log("File written to ./hello.txt");
      
      /** append to the file */
      await Deno.writeTextFile("./hello.txt", "This text will be appended.", {
        append: true,
      });
      
      /** write serialized json object to a file */
      function writeJson(path: string, data: object): string {
        try {
          /** can be "await Deno.writeTextFile" for async function */
          Deno.writeTextFileSync(path, JSON.stringify(data));
          return "written to " + path;
        } catch (e) {
          return e.message;
        }
      }
      console.log(writeJson("./data.json", { hello: "World" }));
    </p>
    
    <a href="#section0">
      <p id="section15" class="t s3">
        Making Scripts Executable (Unix only)
      </p>
    </a>
    
    <a href="https://docs.deno.com/runtime/tutorials/hashbang">Making Scripts Executable With a Hashbang (Shebang)</a>
    
    <a href="#section0">
      <p id="section16" class="t s3">
        Manage External Environment
      </p>
    </a>
    
    <p>
      The <a href="https://www.man7.org/linux/man-pages/man1/env.1.html"><span class="m">
        env</span></a> runs a program in a modified environment.
    </p>
    
    <hr>
    
    <p>
      <span class="m">(--allow-env)</span> Runtime <a href="https://deno.land/api?s=Deno.Env"><span class="m">Deno.Env</span></a> interface to interact with the process environment variables.
    </p>
    
    <hr>
    
    <p>
      <span class="m">(--allow-env)</span> Runtime <a href="https://deno.land/api?s=Deno.env"><span class="m">Deno.env</span></a> provides environment variables.
    </p>
    
    <hr>
    
    <p>
      <span class="m">(--allow-env)</span> Runtime <a href="https://deno.land/api?s=Deno.args"><span class="m">Deno.args</span></a> accesses the command line arguments.
    </p>
    
    <hr>
    
    <p>
      <a href="https://deno.land/api?s=ReadableStream"><span class="m">ReadableStream</span></a> interface represents a readable stream of byte data.
    </p>
    
    <hr>
    
    <p>
      <a href="https://deno.land/api?s=WritableStream"><span class="m">WritableStream</span></a> interface provides a standard abstraction for writing streaming data to a destination, known as a sink.
    </p>
    
    <hr>
    
    <p>
      File System <a href="https://deno.land/api?s=Deno.FsFile#prop_readable"><span class="m">Deno.FsFile.readable</span></a> is used to get a readable stream from the file. This readable stream closes the file when it is finished reading, so it is not necessary to close the file explicitly.
    </p>
    
    <hr>
    
    <p>
      File System <a href="https://deno.land/api?s=Deno.FsFile#prop_writable"><span class="m">Deno.FsFile.writable</span></a> is used to write the contents of the file.
    </p>
    
    <hr>
    
    <p>
      <span class="m">(--allow-read)</span> File System <span class="m">Deno.open</span> is used to get a handle to a file.
    </p>
    
    <hr>
        
    <p>
      <span class="m">(--allow-write)</span> File System <a href="https://deno.land/api?s=Deno.remove"><span class="m">Deno.remove</span> Removes the named file or directory.</a>
    </p>
    
    <p class="c s1">
      await Deno.remove("/path/to/empty_dir/or/file");
      await Deno.remove("/path/to/populated_dir/or/file", { recursive: true });
    </p>
    
    <hr>
    
    <p>
      <span class="m">(--allow-read --allow-write)</span> File System <a href="https://deno.land/api?s=Deno.rename"><span class="m">Deno.rename</span></a>
    </p>
    
    <hr>
    
    <p>
      <span class="m">(--allow-write)</span> File System <a href="https://deno.land/api?s=Deno.mkdir"><span class="m">Deno.mkdir</span></a> creates a new directory with the specified path.
    </p>
    
    <hr>
    
    <p>
      <span class="m">(--allow-read --allow-write)</span> File System <a href="https://deno.land/api?s=Deno.create"><span class="m">Deno.create</span></a> creates a new directory with the specified path.
    </p>
    
    <hr>
    
    <p>
      <span class="m">(--allow-read)</span> File System <a href="https://deno.land/api?s=Deno.readDir"><span class="m">Deno.readDir</span></a> reads the directory given by <span class="m">path</span> and returns an async iterable of <a href="https://deno.land/api?s=Deno.DirEntry"><span class="m">Deno.DirEntry</span></a> information about a directory entry.
    </p>
    
    <p class="c s1">
      for await (const dirEntry of Deno.readDir("/")) {
        console.log(dirEntry.name);
      }
    </p>
    
    <hr>
    
    <p>
      <span class="m">(--allow-write)</span> File System <a href="https://deno.land/api?s=Deno.chmod"><span class="m">Deno.chmod</span></a> changes the permission of a specific file/directory of specified path using sequence of 3 octal numbers.
    </p>
    
    <p class="c s1">
      await Deno.chmod("/path/to/file", 0o666);
    </p>
    
    <a href="#section0">
      <p id="section17" class="t s3">
        Manage built-in KV(key/value) Database
      </p>
    </a>
    
    <p>
      Steps to create the database, place it in desirable folder and use.
    </p>
    
    <p>
      1. Create database in project root folder. Include <span class="m">const kv = await Deno.openKv("db");</span> syntax in your <span class="m">main.ts</span> file. After the first success execution the database files will be created in root folder.
    </p>
    
    <p>
      2. Create desirable folder structure and move created database files inside destination folder. After that check the correct path to new database destination using next syntax in <span class="m">main.ts</span>. Correct the appendix of <span class="m">join</span> according to your file structure.
    </p>
    
    <p class="c s1">
      import { join } from "https://deno.land/std@0.224.0/path/mod.ts";
      const db_path = join(Deno.cwd(), "some/path/to/db");
      console.log(db_path);
      // const kv = await Deno.openKv("db"); // commented to avoid recreate in root
    </p>
    
    <p>
      3. When <span class="m">db_path</span> looks correct, use it to manage database.
    </p>
    
    <p class="c s1">
      import { join } from "https://deno.land/std@0.224.0/path/mod.ts";
      const db_path = join(Deno.cwd(), "correct/path/to/db");
      console.log(db_path);
      const kv = await Deno.openKv(db_path);
      console.log(kv); // to print and confirm some structure in console
    </p>
    
    <p>
      After correct settings, you can use key/value database in deno deploy as part of deployed repository. Under the hood deno uses external provider to manage built-in databases. Free plan has some limitations(according to official docs).
    </p>
    
  </body>
  <script src="../script.js"></script>
</html>
